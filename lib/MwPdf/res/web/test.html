<html>
<head>
    <meta charset="UTF-8"/>
    <title>test</title>
    <style>

        * {
            font-family: Arial;
        }

        body {
            background-color: #DDDDEE;
        }

        #container {
            display: flex;
            justify-content: center;
        }

        form {
            width: 40em;
        }

        #tutContainer {
            position: relative;
            height: 50em;
            margin-bottom: 0.5em;
            background-color: white;
        }

        input, textarea {
            width: 100%;
            padding: 0.5em;
            font-size: 14px;
            line-height: 120%;
        }

        #data {
            height: 100%;
            font-family: monospace;
            position: absolute;
            left: 0;
            top: 0;
            background-color: transparent;
        }

        #iframe {
            background-color: #FFF;
            width: 40em;
            height: 53em;
            border: 1px solid #000;
        }

        form button {
            background-color: #8888AA;
            border: 1px solid #000;
            color: #FFF;
            float: right;
            padding: 0.5em;
            margin-left: 0.5em;
        }

        #butt {
            font-weight: bold;
            border: 2px solid #000;
        }

        #tutButtons {
            margin-bottom: 0.5em;
            display: flex;
        }
        #tutButtons button {
            width: 150px;
            display: block;
            margin-bottom: 0.2em;
            margin-right: 0.1em;
            text-align: left;
        }
        #tutButtons button[data-tut=""] {
            color: #666;
        }
        #tutButtons div {

        }

        h4 {
            margin-bottom: 0.5em;
        }

    </style>

</head>
<body>

<h4>mwpdf r8</h4>

<div id="container">

    <div id="tutButtons">

        <div>
            <button data-tut="001Hello">Hello World</button>

            <br/>

            <button data-tut="002Structure">Seitenstruktur</button>
            <button data-tut="003Meta">Meta-Daten</button>
            <button data-tut="004Schema">Validierung</button>
            <button data-tut="005SinglePage">Einzelne Seite</button>
            <button data-tut="006MultiPage">Multi-Seite</button>
            <button data-tut="007MultiCol">Mehrspaltig</button>
            <button data-tut="008Margins">Seite/Ränder</button>
            <button data-tut="009HeaderFooter">Kopf/Fuß</button>
            <button data-tut="050BatesNumbers">Bates numbers</button>
            <button data-tut="051Background">Hintergrund</button>
            <button data-tut="052Foreground">Vordergrund</button>

            <br/>

            <button data-tut="031ColRowFlex">Col/Row/Flex</button>
            <button data-tut="023ListView">Listview</button>
            <button data-tut="022Partitions">Partitions</button>
            <button data-tut="021Grid">Grid</button>
            <button data-tut="020StackPositioned">Stack/Positioned</button>
            <button data-tut="019ClipDecorations">Clips/Decoration</button>

            <br/>

            <button data-tut="010Textstyles">Textstyles</button>
            <button data-tut="011RichtextMarkdown">Richtext/Markdown</button>
            <button data-tut="012Silbentrennung">Silbentrennung</button>
            <button data-tut="013FontsIcons">Fonts/Icons</button>
            <button data-tut="018BulletsLists">Bullets/Gliederung</button>

            <br/>

            <button data-tut="016Barcodes">Barcodes</button>
            <button data-tut="030Datenquellen">Datenquellen</button>
            <button data-tut="024Charts">Diagramme</button>
            <button data-tut="017Bilder">Bilder</button>
            <button data-tut="026Tables1">Tabellen 1</button>
            <button data-tut="027Tables2">Tabellen 2</button>
            <button data-tut="028Tables3">Tabellen 3</button>
            <button data-tut="015Graphics">Grafiken</button>
            <button data-tut="014Millimeterpapier">Millimeterpapier</button>
            <button data-tut="056School">Liniertes Papier</button>

        </div>
        <div>

            <button data-tut="025Inhaltverzeichnis">Inhaltsverzeichnis</button>
            <button data-tut="029LinksAnker">Links</button>
            <button data-tut="053Formulare">Formulare</button>
            <button data-tut="054Wasserzeichen">Wasserzeichen</button>
            <!--            <button data-tut="">Anmerkungen</button>-->
            <br />

            <button data-tut="059Helpers">Helpers</button>
            <button data-tut="040Variablen">Variablen</button>
            <button data-tut="035Conditionals">Conditionals</button>
            <button data-tut="039TableSums">Tabellen/Summen</button>
            <button data-tut="058Yahtzee" data-yaml="1">Widget Re-use</button>
            <button data-tut="033TemplatePrepare">Prepare template</button>
            <button data-tut="034TemplateUse">Use template</button>
            <button data-tut="038Yaml" data-yaml="1">Yaml to the rescue</button>
            <br/>

            <button data-tut="036ShowcaseHHEnergie">Showcase: HH Energie</button>
            <button data-tut="037ShowcaseMwDoc">Showcase: MW Doc1</button>
            <button data-tut="055ShowcaseWillyTel">Showcase: WillyTel</button>
            <button data-tut="041ExpCalendar">Experiment, Kalender</button>
            <button data-tut="042ExpComic">Experiment, Comic panels</button>
            <button data-tut="043ExpBaderegeln">Scribble, Baderegeln</button>
            <button data-tut="044Sudoku1">Sudoku&Co</button>
            <button data-tut="045Sudoku2">Sudoku&Co (2)</button>
            <button data-tut="057Avery">Zweckform Etiketten</button>
            <br/>

            <button data-tut="032InvoiceFacturX">Factur-x/CII</button>
            <button data-tut="046InvoiceXRechnung">XRechnung/UBL</button>
            <button data-tut="048InvoiceSui">SUI qr-invoice</button>
            <button data-tut="049InvoiceEPC">EPC qr-invoice</button>
            <button data-tut="047InvoiceKSA">KSA qr-invoice</button>
            <button data-tut="060SimpleInvoice">CII-Automatik</button>
            <button data-tut="061XmlInvoice">CII-XML-Invoice</button>
            <br/>


        </div>
    </div>

    <div style="width:1em"></div>

    <form>
        <div id="tutContainer">
            <textarea id="data">
</textarea>
        </div>
        <!--        <input id="auth" type="text" value="myRootKey" placeholder="Authkey"/><br/>-->
        <!--        <br />-->

        <button id="butt">Create<br />PDF &raquo;</button>
        <button id="validate">Validate<br/>Json</button>

        <button id="template">Create<br />Template</button>
        <button id="invoice">
            Extract<br />Invoice XML</button>
        <button id="schemax">Schema<br />UBL</button>
        <button id="schemaf">Schema<br />CII</button>
        <button id="schema">Jon<br />Schema</button>
        <button id="clear">Clear<br />All</button>

    </form>

    <div style="width:1em"></div>

    <iframe id="iframe" frameborder="0"></iframe>

</div>

<script>

    let bt = document.querySelectorAll('button[data-tut]');
    for (var i = 0; i < bt.length; i++) {
        bt[i].onclick = function (e) {
            e.preventDefault();
            let t = this.getAttribute('data-tut');
            let y = this.getAttribute('data-yaml');
            loadTut(t, y);
        }
    }

    document.getElementById('clear').onclick = function (e) {
        e.preventDefault();

        document.getElementById('data').value = '';
    }

    document.getElementById('butt').onclick = function (e) {
        e.preventDefault();

        let xhr = new XMLHttpRequest;
        xhr.open('post', '/api/pdf', true);
        xhr.setRequestHeader(
            'Authorization',
            'myRootKey'
        );
        xhr.responseType = 'arraybuffer';
        xhr.onload = function (e) {
            if (xhr.status == 200) {
                let content = this.response;
                let blob = new Blob([content], {type: 'application/pdf'});
                let url = URL.createObjectURL(blob);
                let i = document.getElementById('iframe');
                i.src = url;
                i.hidden = false;
            } else {
                let td = new TextDecoder("utf-8");
                let s = td.decode(this.response);
                alert(s);
            }
        };
        let data = document.getElementById('data').value;
        xhr.send(data);
    }

    document.getElementById('validate').onclick = function (e) {
        e.preventDefault();

        let xhr = new XMLHttpRequest;
        xhr.open('post', '/api/validate', true);
        xhr.setRequestHeader(
            'Authorization',
            'myRootKey'
        );
        xhr.onload = function (e) {
            let content = this.response;
            let blob = new Blob([content], {type: 'text/plain'});
            let url = URL.createObjectURL(blob);
            let i = document.getElementById('iframe');
            i.src = url;
            i.hidden = false;
        };
        let data = document.getElementById('data').value;
        xhr.send(data);
    }

    document.getElementById('template').onclick = function (e) {
        e.preventDefault();

        let xhr = new XMLHttpRequest;
        xhr.open('post', '/api/template', true);
        xhr.setRequestHeader(
            'Authorization',
            'myRootKey'
        );
        xhr.onload = function (e) {
            let content = this.response;
            let blob = new Blob([content], {type: 'text/plain'});
            let url = URL.createObjectURL(blob);
            let i = document.getElementById('iframe');
            i.src = url;
            i.hidden = false;
        };
        let data = document.getElementById('data').value;
        xhr.send(data);
    }

    document.getElementById('invoice').onclick = function (e) {
        e.preventDefault();

        let xhr = new XMLHttpRequest;
        xhr.open('post', '/api/invoice', true);
        xhr.setRequestHeader(
            'Authorization',
            'myRootKey'
        );
        xhr.onload = function (e) {
            // let content = this.response;
            // document.getElementById('data').value = content;
            let content = this.response;
            let blob = new Blob([content], {type: 'text/plain'});
            let url = URL.createObjectURL(blob);
            let i = document.getElementById('iframe');
            i.src = url;
            i.hidden = false;
        };
        let data = document.getElementById('data').value;
        xhr.send(data);
    }

    document.getElementById('schema').onclick = function (e) {
        e.preventDefault();

        let xhr = new XMLHttpRequest;
        xhr.open('get', '/api/schema', true);
        xhr.setRequestHeader(
            'Authorization',
            'myRootKey'
        );
        xhr.onload = function (e) {
            let content = this.response;
            let blob = new Blob([content], {type: 'text/plain'});
            let url = URL.createObjectURL(blob);
            let i = document.getElementById('iframe');
            i.src = url;
            i.hidden = false;
        };
        xhr.send({});
    }

    document.getElementById('schemaf').onclick = function (e) {
        e.preventDefault();

        let xhr = new XMLHttpRequest;
        xhr.open('get', '/api/schemaf', true);
        xhr.setRequestHeader(
            'Authorization',
            'myRootKey'
        );
        xhr.onload = function (e) {
            let content = this.response;
            let blob = new Blob([content], {type: 'text/plain'});
            let url = URL.createObjectURL(blob);
            let i = document.getElementById('iframe');
            i.src = url;
            i.hidden = false;
        };
        xhr.send({});
    }

    document.getElementById('schemax').onclick = function (e) {
        e.preventDefault();

        let xhr = new XMLHttpRequest;
        xhr.open('get', '/api/schemax', true);
        xhr.setRequestHeader(
            'Authorization',
            'myRootKey'
        );
        xhr.onload = function (e) {
            let content = this.response;
            let blob = new Blob([content], {type: 'text/plain'});
            let url = URL.createObjectURL(blob);
            let i = document.getElementById('iframe');
            i.src = url;
            i.hidden = false;
        };
        xhr.send({});
    }

    loadTut = function (nr, yaml) {

        console.log(yaml);

        let xhr = new XMLHttpRequest;
        xhr.open('get', '/tut/' + nr + (yaml ? '.yaml' : '.json'), true);
        xhr.setRequestHeader(
            'Authorization',
            'myRootKey'
        );
        xhr.onload = function (e) {
            let content = this.response;
            document.getElementById('data').value = content;
        };
        xhr.send({});
    }

    loadTut('001Hello');

</script>
</body>
</html>